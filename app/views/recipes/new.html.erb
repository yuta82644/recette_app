<div class="footer_fixed">


<h1>レシピ投稿</h1>
<%= form_with(model: @recipe, local: true) do |f| %>
<div class="recipe_new wrapper">
  <div class="recipe_container">

    <div class="image_area">
      <div class="image_box"></div>
          <%= f.label :image %>
          <%= f.file_field :image %>
    </div>


<div class="recipe_text_area">
    <div class="recipe_title_text">
      <div class="recipe_title">

        <%= f.text_field :title, class: "title_form", placeholder:"title" %>
      </div>
      <div class= "recipe_quantity">

        <%= f.text_field :tortal_quantity, class: "tortal_quantity_form", placeholder:"出来高" %>
      </div>
    </div>
      <div class="short_comment_area">
       
        <%= f.text_area :short_comment, class: "short_comment_form", placeholder:"一言コメント"  %>
      </div>

 <h2>材料</h2>
<div id="cooking_ingredients">
  <%= f.fields_for :cooking_ingredients do |ingredient| %>
    <div class="ingredient_container">
      <div class="ingredint_area">
        <%= ingredient.text_field :ingredient_name, class: "ingredint_form" %>
      </div>
      <div class="quntity_area">
        <%= ingredient.number_field :quantity, class: "quntity_form" %>
      </div>
      <div class="unit_area">
        <%= ingredient.text_field :unit, class: "unit_form" %>
      </div>
      <button class="trash3" type="button" onclick="removeIngredient(this)">
        <i class="bi bi-trash3"></i>
      </button>
    </div>
  <% end %>
</div>
<button type="button" class="bar_down_btn" id="addIngredient"><i class="bi bi-arrow-bar-down"></i></button>
</div>




</div>

  <h2>手順</h2>
  <%= f.fields_for :procedures do |step| %>
    <div>
      <%= step.label :procedure_comment %>
      <%= step.text_area :procedure_comment %>
    </div>
  <% end %>


  <div>
    <%= f.label :public %>
    <%= f.check_box :public %> <!-- 一般公開のチェックボックスを追加 -->
  </div>
  <div>
  <%= f.label :room_id %>
  <% if @user_rooms.present? %>
    <%= f.select :room_id, options_for_select(@user_rooms.pluck(:name, :id)), {}, class: "form-control" %>
  <% else %>
    <%= f.select :room_id, options_for_select([["一般公開", nil]]), {}, class: "form-control" %>
  <% end %>
</div>
<div>
  <%= f.label :category_ids, "Categories" %>
  <%= f.collection_select :category_ids, Category.all, :id, :name, {}, { multiple: true } %>
</div>



  <%= f.submit "投稿" %>

<% end %>
</div>



<%= form_with(model: Category.new, url: categories_path, local: true) do |f| %>
  <div class="form-group">
    <%= f.label :name, "新しいカテゴリー名" %>
    <%= f.text_field :name, class: "form-control" %>
  </div>

  <%= f.submit "作成", class: "btn btn-primary" %>
<% end %>

</div>

<%= javascript_pack_tag 'recipe_field.js' %>



  <%# // JavaScript for adding and removing ingredient fields
  <script>
  document.addEventListener("DOMContentLoaded", function() {
    const addIngredientButton = document.getElementById("addIngredient");
  const ingredientsContainer = document.getElementById("cooking_ingredients");

  // Function to create a new ingredient field
  function createIngredientField() {
      const ingredientContainer = document.createElement("div");
  ingredientContainer.classList.add("ingredient_container");

  const ingredientArea = document.createElement("div");
  ingredientArea.classList.add("ingredint_area");
  const ingredientInput = document.createElement("input");
  ingredientInput.type = "text";
  ingredientInput.name = "recipe[cooking_ingredients_attributes][][ingredient_name]";
  ingredientInput.classList.add("ingredint_form");
  ingredientArea.appendChild(ingredientInput);

  const quantityArea = document.createElement("div");
  quantityArea.classList.add("quntity_area");
  const quantityInput = document.createElement("input");
  quantityInput.type = "number";
  quantityInput.name = "recipe[cooking_ingredients_attributes][][quantity]";
  quantityInput.classList.add("quntity_form");
  quantityArea.appendChild(quantityInput);

  const unitArea = document.createElement("div");
  unitArea.classList.add("unit_area");
  const unitInput = document.createElement("input");
  unitInput.type = "text";
  unitInput.name = "recipe[cooking_ingredients_attributes][][unit]";
  unitInput.classList.add("unit_form");
  unitArea.appendChild(unitInput);

  const deleteButton = document.createElement("button");
  deleteButton.classList.add("trash3");
  deleteButton.type = "button";
  deleteButton.innerHTML = '<i class="bi bi-trash3"></i>';
  deleteButton.onclick = function() {
    ingredientsContainer.removeChild(ingredientContainer);
      };

  ingredientContainer.appendChild(ingredientArea);
  ingredientContainer.appendChild(quantityArea);
  ingredientContainer.appendChild(unitArea);
  ingredientContainer.appendChild(deleteButton);

  ingredientsContainer.appendChild(ingredientContainer);
    }

  // Add event listener to the "Add Ingredient" button
  addIngredientButton.addEventListener("click", function() {
    createIngredientField();
    });

  // Function to remove an ingredient field
  function removeIngredient(button) {
      const ingredientContainer = button.closest(".ingredient_container");
  if (ingredientContainer) {
    ingredientsContainer.removeChild(ingredientContainer);
      }
    }
  });
  alert('JavaScriptのアラート');
  </script>  %>